!function(){const e=document.getElementById("message-container"),t=document.getElementById("send-container"),n=document.getElementById("message-input");let o,s,c,r=!1;for(;;)try{if(o=prompt("What is your name?").trim(),0!=o.length){o=o.substring(0,10);break}}catch(e){console.log("이름을 작성해주세요")}var a=io({reconnection:!1});function i(){l({message:"disconnected"},"info"),n.value="",n.disabled=!0,document.querySelector("#send-button").disabled=!0}function l(t,n="me"){let{message:o,name:a,color:i}=t;a||(a="unknown");const l=document.createElement("div");let p,h,f=document.createTextNode(o);switch(n){case"me":l.className=n,p=document.createElement("div"),p.className="msg",p.appendChild(f),h=document.createElement("div"),h.className="time",h.innerHTML=m(),l.appendChild(p),l.appendChild(h),"me"==c?.className&&u(c,h),s="",c=l;break;case"other":l.className=n;const e=document.createElement("div");e.className="profileimg",e.innerHTML=a[0].toUpperCase(),e.style.backgroundColor=i,e.style.color=(g=i)?parseInt(g.replace("#",""),16)>8388607.5?"#000000":"#ffffff":"";const t=document.createElement("div");t.className="namentime";const o=document.createElement("div");o.className="uname",o.appendChild(document.createTextNode(a)),p=document.createElement("div"),p.className="msg",p.appendChild(f),h=document.createElement("div"),h.className="time",h.innerHTML=m(),s!=i?(l.appendChild(e),t.appendChild(o)):u(c,h),t.appendChild(p),t.appendChild(h),l.appendChild(t),s=i,c=t;break;default:l.className=n,l.appendChild(f),s="",setTimeout((()=>{!function(){let e=document.createElement("li");e.innerHTML='<li class="list-group-item head">User List</li>';fetch("/users").then((e=>{if(200===e.status)return e.json();throw new Error("Something went wrong on api server!")})).then((t=>{console.log("fetch",t);for(const n in t)if(t.hasOwnProperty(n)){const o=t[n],s=document.createElement("li");s.className="list-group-item",s.appendChild(document.createTextNode(o)),e.appendChild(s)}d.innerHTML=e.innerHTML})).catch((e=>{console.error(e)}))}()}),300)}var g;e.append(l),r||e.scrollBy({top:e.scrollHeight,behavior:"smooth"})}a.emit("new-user",o),l({message:`${o} joined`},"info"),a.on("chat-message",(e=>{l(e,"other")})),a.on("user-connected",(e=>{l({message:`${e} connected`},"info")})),a.on("user-disconnected",(e=>{l({message:`${e} disconnected`},"info")})),a.on("disconnect",(()=>{i()})),a.on("bye",(()=>{i()})),t.addEventListener("submit",(e=>{e.preventDefault();const t=n.value.trim();0!=t.length&&(l({message:t}),a.emit("send-chat-message",t),n.value="",p(),document.querySelector("#message-input").focus())})),n.addEventListener("input",(function(){0==n.value.trim().length?document.querySelector("#send-button").style.color="#9e9e9e":document.querySelector("#send-button").style.color=""}),!1),Object.defineProperty(String.prototype,"hashCode",{value:function(){var e,t=0;for(e=0;e<this.length;e++)t=(t<<5)-t+this.charCodeAt(e),t|=0;return t}});const d=document.querySelector("#user-list > ul");function m(){var e=new Date,t=e.getHours(),n=e.getMinutes();return`${t}:${n=function(e){e<10&&(e="0"+e);return e}(n)}`}function u(e,t){let n;for(var o=0;o<e.childNodes.length;o++)if("time"==e.childNodes[o].className){n=e.childNodes[o];break}n?.innerHTML==t.innerHTML&&(n.style.display="none")}function p(){document.querySelector("#send-button").style.color="#9e9e9e"}p(),e.addEventListener("scroll",(function(e){const{offsetHeight:t,scrollTop:n,scrollHeight:o}=e.target;!r&&o-(t+n)>=60?r=!0:r&&o-(t+n)<60&&(r=!1)}))}();
//# sourceMappingURL=index.06c81f88.js.map
